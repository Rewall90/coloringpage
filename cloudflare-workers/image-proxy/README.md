# Image Proxy Worker

Cloudflare Worker that serves images from Sanity CDN with SEO-friendly hierarchical URLs.

## Purpose

Transforms Sanity CDN image URLs into hierarchical URLs that match your site structure:

- **Before**: `https://cdn.sanity.io/images/zjqmnotc/production/b86abf0fc661ed4c7c38f30303ba894c0306b848-1024x1024.webp`
- **After**: `https://www.coloringvault.com/mythical-creatures/category-hero.webp`

## Features

- **Hierarchical URLs**: `/category/image-name.ext` format
- **Multiple formats**: Supports .webp, .jpg, .jpeg, .png
- **Optimized caching**: 7 days edge cache, 1 year browser cache
- **Shared KV store**: Uses same mappings as PDF proxy
- **SEO-friendly**: Proper content headers for search engines

## Routes

The worker handles image requests for:
- `*.webp`
- `*.jpg` / `*.jpeg` 
- `*.png`

## Deployment

```bash
# Install dependencies
npm install

# Deploy to Cloudflare
npm run deploy

# Upload mappings (shared with PDF proxy)
npm run upload-mappings
```

## URL Structure

Images follow the hierarchical pattern:
```
/category/image-type.ext
/mythical-creatures/category-hero.webp
/animals/category-thumbnail.jpg
```

## Integration

This worker shares the KV namespace with the PDF proxy, allowing both workers to access the same asset mappings generated by the Hugo build process.