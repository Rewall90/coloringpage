{{/* Coloring Page Embed Shortcode */}}
{{ $title := .Get "title" }}
{{ $description := .Get "description" }}
{{ $image := .Get "image" }}
{{ $pdf := .Get "pdf" }}

<div class="coloring-page-embed my-8 p-4 bg-neutral-50 dark:bg-neutral-800 rounded-lg border border-neutral-200 dark:border-neutral-700" role="region" aria-labelledby="coloring-page-{{ .Get "title" | urlize }}">
  <div class="flex flex-col gap-4">
    {{/* Image section */}}
    {{ if $image }}
      <div class="w-full">
        {{/* Use local image path - no more Cloudflare Workers! */}}
        <img 
          src="{{ $image }}" 
          alt="{{ $title }}"
          class="w-full h-auto rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 aspect-square object-cover"
          width="750"
          height="1000"
          loading="lazy"
        >
      </div>
    {{ end }}
    
    {{/* Content section */}}
    <div class="flex-1 space-y-3">
      <h4 id="coloring-page-{{ .Get "title" | urlize }}" class="text-lg font-bold text-neutral-900 dark:text-neutral-100">
        {{ $title }}
      </h4>
      
      {{ if $description }}
        <p class="text-sm text-neutral-600 dark:text-neutral-400">
          {{ $description }}
        </p>
      {{ end }}
      
      {{/* Download and Print buttons */}}
      <div class="flex flex-col gap-2">
        {{ if $pdf }}
          {{/* Use different URLs based on environment */}}
          {{ if eq hugo.Environment "development" }}
            {{/* Development: Use direct Sanity CDN URLs */}}
            <a 
              href="{{ $pdf }}" 
              target="_blank"
              class="px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors duration-300 text-base text-center"
            >
              Download Coloring Page
            </a>
          {{ else }}
            {{/* Production: Use Cloudflare Worker URLs */}}
            {{ $pdfSlug := $title | lower | replaceRE "[^a-z0-9]+" "-" | replaceRE "^-|-$" "" }}
            {{ $categorySlug := .Page.Section }}
            {{ $pageSlug := .Page.File.BaseFileName }}
            <a 
              href="/pdf/{{ $categorySlug }}/{{ $pageSlug }}/{{ $pdfSlug }}" 
              target="_blank"
              class="px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors duration-300 text-base text-center"
            >
              Download Coloring Page
            </a>
          {{ end }}
        {{ end }}
      </div>
    </div>
  </div>
</div>

