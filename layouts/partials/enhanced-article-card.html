{{/* Enhanced Article Card - Single Base Image with Dynamic Transformations */}}
{{ $disableImageOptimization := .Page.Site.Params.disableImageOptimization | default false }}

<div class="group-hover-card group relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  <a {{ partial "article-link/_external-link.html" . | safeHTMLAttr }} class="absolute inset-0" aria-label="{{ $.Title }}"></a>
  
  {{/* Enhanced Image Section - Dynamic Transformations */}}
  {{ $baseImageUrl := .Params.base_image_url }}
  {{ $enhancedResponsive := .Params.enhanced_responsive }}
  {{ $imageAlt := .Params.image_alt | default .Title }}
  
  {{ if $baseImageUrl }}
    {{/* New enhanced approach - single base image with dynamic sizing */}}
    <figure class="w-full overflow-hidden aspect-[3/4]">
      <img decoding="async" 
           src="{{ $baseImageUrl }}?w=300&h=400&fit=cover&q=85"
           alt="{{ $imageAlt }}"
           class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
           srcset="{{ $baseImageUrl }}?w=200&h=267&fit=cover&q=75 200w,
                   {{ $baseImageUrl }}?w=300&h=400&fit=cover&q=85 300w,
                   {{ $baseImageUrl }}?w=768&h=1024&fit=cover&q=85 768w,
                   {{ $baseImageUrl }}?w=896&h=1195&fit=cover&q=85 896w"
           sizes="(max-width: 300px) 200px, (max-width: 768px) 300px, (max-width: 1024px) 768px, 896px"
           loading="lazy"
           data-pin-url="{{ absURL .RelPermalink }}"
           data-pin-title="{{ .Title }} | {{ site.Title }}"
           data-pin-description="{{ .Summary | default "Free, premium printable coloring pages for kids. Easy access and zero cost for endless fun and creativity!" }}">
    </figure>
    
  {{ else if .Params.responsive_images }}
    {{/* Backward compatibility - existing 4-size approach */}}
    <figure class="w-full overflow-hidden aspect-[3/4]">
      <noscript>
        <img decoding="async" 
             src="{{ .Params.responsive_images.thumbnail_300 }}" 
             alt="{{ $imageAlt }}"
             sizes="(max-width: 300px) 100vw, 300px">
      </noscript>
      <img decoding="async" 
           width="300" 
           height="400"
           src="{{ .Params.responsive_images.thumbnail_300 }}" 
           alt="{{ $imageAlt }}"
           class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
           srcset="{{ .Params.responsive_images.thumbnail_200 }} 200w,
                   {{ .Params.responsive_images.thumbnail_300 }} 300w,
                   {{ .Params.responsive_images.thumbnail_768 }} 768w,
                   {{ .Params.responsive_images.thumbnail_896 }} 896w"
           sizes="(max-width: 300px) 100vw, 300px"
           loading="lazy"
           data-pin-url="{{ absURL .RelPermalink }}"
           data-pin-title="{{ .Title }} | {{ site.Title }}"
           data-pin-description="{{ .Summary | default "Free, premium printable coloring pages for kids. Easy access and zero cost for endless fun and creativity!" }}">
    </figure>
    
  {{ else }}
    {{/* Fallback to original image logic */}}
    {{ $heroImage := .Params.image }}
    {{ if $heroImage }}
      <figure class="w-full overflow-hidden aspect-[3/4]">
        <img decoding="async"
             loading="lazy"
             src="{{ $heroImage }}"
             alt="{{ $imageAlt }}"
             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" />
      </figure>
    {{ else }}
      {{/* No image available - show placeholder */}}
      <div class="w-full aspect-[3/4] bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center">
        <span class="text-white text-lg font-medium">{{ .Title }}</span>
      </div>
    {{ end }}
  {{ end }}
  
  {{/* Draft Badge */}}
  {{ if and .Draft .Site.Params.article.showDraftLabel }}
    <span class="absolute top-0 right-0 m-2">
      {{ partial "badge.html" (i18n "article.draft" | emojify) }}
    </span>
  {{ end }}
  
  {{/* Content Section */}}
  <div class="px-6 py-4">
    {{ with .Params.externalUrl }}
      <h3 class="group-hover-card-title decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 group-hover:underline group-hover:underline-offset-2">
        {{ $.Title | emojify }}
        <span class="cursor-default align-top text-xs text-neutral-400 dark:text-neutral-500">
          <span class="rtl:hidden">&#8599;</span>
          <span class="ltr:hidden">&#8598;</span>
        </span>
      </h3>
    {{ else }}
      <h3 class="group-hover-card-title decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 group-hover:underline group-hover:underline-offset-2">
        {{ .Title | emojify }}
      </h3>
    {{ end }}
  </div>
</div>